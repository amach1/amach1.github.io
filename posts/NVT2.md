---
title: 诺瓦泰718D+北斗星通UM980+2128集成
date: 2024-02-11
tags: [硬件, GPS, RTK，飞控]
head:
  - - meta
    - name: 诺瓦泰718D+北斗星通UM980+2128g
      content: 诺瓦泰718D+北斗星通UM980+2128g
  - - meta
    - name: 诺瓦泰718D+北斗星通UM980+2128g
      content: 诺瓦泰718D+北斗星通UM980+2128g
---

并没有想象中那么精确。

---

# 前言
::: tip
本文参考信息 [GNSS受信機NovAtel OEM729の導入 - 高橋 賢](https://s-taka.org/novatel-oem729-gnss-receiver/)
:::
苦等的开发板终于到了，下一步就是集成安装调试。 
## 开发板信息
这块开发板支持8-24v供电，共计引出两路RS232串口及一个RJ45网口。其中右下角那两根插针是用来设置PPS输出的，插入跳线帽之后就会在COM1的引脚9输出PPS时钟信号。  

![Caption](/718DK.jpg)    
### 开发板配置  

需要输入以下命令来配置校正源通道的输出冲突：  
```ini
Interfacemode com2 auto none off
Interfacemode com2 rtcmv3 none off
saveconfig
```  

## 接收机信息
这块板子在厂家发货时就已经附带了外壳以及供电模块，本以为会买来两块718D,结果却是极端混搭，遂只能参考诺瓦泰官方说明书以及飞控说明书硬着头皮集成。
![Caption](/UM980.jpg)  
里面的板子引出了两路RS232串口以及一个天线+DC输入，配套电源来自明纬，并且附带3个状态显示灯（供电、COM1、COM2）。  
绿灯表示数据输出/供电正常,黄灯表示有接收到可识别的数据,红色表示接收到了不可识别的数据。
### 接收机配置
使用北斗星通的UPrecise与板卡建立通讯，原始数据输入version查看板卡型号。  
以下是配置所需命令：  
```ini
Mode base time 60
Rtcm1004 com2 1
Rtcm1006 com2 1
Rtcm1012 com2 1
Rtcm1033 com2 1
Rtcm1124 com2 1
Saveconfig
```  
这样一来，基站就会在COM2输出RTCM校正信息。  
退出之前记得把COM2的波特率改为718D的对应串口相同的波特率。

## 连接测试
当上述配置步骤都完成后，就可以通过一根公对公RS232串口线来进行通讯测试了（记得测试23引脚与32引脚之间的连通性）。设备上电后，使用电脑连接OEM718D的COM1，并打开novatel connect进行状态确认。当RTK数据正常时，配置页面的RTK ROVER后面会有√并显示为绿色背景（不正常时则为红色），后面就可以查看第一页的定位状态信息了。  
目前看到的定位类型有L1flt、L1int(似乎这样精度最高？)、伪距差分（米级）、窄浮点解（一般在几十厘米）、窄固定解（厘米级）。如果RTK数据更新频率稳定且模式稳定，就可以确认配置没有问题。后面是想上数传电台还是怎么玩就看自己的心情了。  
当然，这次的主要目的是集成到2128，后面还有一段描述这一部分工作的内容。

## 飞控信息
一块昂贵的飞控，贵就算了还不好用。客户支持也稀烂。
### 连接方式
把718D的COM1使用232toTTL引出,TX引脚接TP16,RX引脚接TP22，PPS直接给TP4。  
![Caption](/TP.jpg) 

### 配置内容
VRS中通讯选项卡选择GPS——TPU，RX引脚22 TX引脚16 波特率57600（别忘了配置718）。  
GPS选项卡选择诺瓦泰、波特率57600、更新频率10、PPS引脚 填4（丫丫：昂？）。载波相位设置中记得选择双天线，勾选718D双天线即可，COM口不用管（给双诺瓦泰机载端做双天线用的）。  
传感器选项卡磁罗盘1中选择诺瓦泰航向。

### 上机测试
VRS配置完成后，就可以打开传感器监测并给飞控上电查看RTK状态了。如果一直提示GPS无效，就要看看是不是718D的波特率没有设置成功了（这东西似乎有BUG，经常会变成其他波特率）。  
当GPS显示绿色或差分GPS之后，就可以查看传感器信息确认定位精准度了（主要依靠双天线间距确认），顺便看看航向是否准确。  

![Caption](/VRSTEST2.jpg)   
![Caption](/VRSTEST1.jpg)   